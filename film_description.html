<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="style.css" rel="stylesheet" type="text/css">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <script src="./script.js" charset="utf-8"></script>

    <!-- NavBar + Footer -->
    <script src="./NavbarAndFooter.js"></script>


    <title>Hello, world!</title>
    <script src="https://kit.fontawesome.com/e83dbc42ef.js" crossorigin="anonymous"></script>
   <style>
   
    </style>

   
  </head>
  <body onload="genera_descrizione()">
    <!--
        TODO: far in modo che se il film è nei preferiti appaia togli dai preferiti, altrimenti aggiungi nei preferiti
        TODO: sistemare aggiungi ai venduti (non va, cambiato struttura dati, push oggetto e non diretto in lista), prezzi......
        TODO: sistemare aggiungi ai preferiti (non va, cambiato struttura dati, push oggetto e non diretto in lista)
    -->
    <!-- navigation -->
    <script>document.write(navbar)</script>


    <!-- content -->
    <div class="container-fluid">
        
        <div class="row" id="rigaDescrizione">
            <div class="row" style="background-color: rgba(0,0,0,0.85); margin: 0em; padding: 2em;">
                <div class="col-md-4 d-flex align-items-center">
                    <img class="d-flex align-items-center mx-auto" style = "max-width:90%; border-radius: 1em; max-height: 40em; margin-bottom: 2em;" >
                </div>

                <div class="col-md-8">
                    <h1 style="color: white;"></h1>
                    <p style="font-size: medium; color: #c1c1c1;"></p>
                    <div style="color: yellow; margin-bottom: 1em;">
                        
                        <i></i><i></i><i></i><i></i><i style="margin-right: 1em;"></i>
                        <!--
                        <button id="recensione" class="btn btn-outline-warning" onclick="overlay_rec_on('overlay')" >Lascia una recensione</button>
                        -->
                        <a target="_blank" rel="noopener noreferrer">
                            <button type="button" class="btn btn-outline-warning" data-bs-toggle="modal" data-bs-target="#ReviewModal"><i class="fab fa-youtube" style="font-size: 1em; margin-right: 0.2em;"></i><span> Review</span></button>
                        </a>
                        <!-- OVERLAY REVIEW -->
                        <div class="modal fade" id="ReviewModal" tabindex="-1" aria-labelledby="ReviewModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-xl">
                                <div class="modal-content bg-dark text-white">
                                    <div class="modal-header" style="border-bottom: 0px;">
                                        <h5 class="modal-title" id="ReviewModalLabel">Review</h5>
                                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close" ></button>
                                    </div>
                                    <div class="modal-body">
                                        <h5>Lascia la tua recensione...</h5>
                                        <p>Vota il film</p>
                                            <div>
                                                <input name="rating" type="radio" id="rate1" value=1 onclick="document.getElementById('rating').value = this.value" /> 
                                                <label for="rate1">1</label>
                                            
                                                <input name="rating" type="radio" id="rate2" value=2 onclick="document.getElementById('rating').value = this.value" />
                                                <label for="rate2">2</label>
                                            
                                                <input name="rating" type="radio" id="rate3" value=3 onclick="document.getElementById('rating').value = this.value" />
                                                <label for="rate3">3</label>
                                            
                                                <input name="rating" type="radio" id="rate4" value=4 onclick="document.getElementById('rating').value = this.value" />
                                                <label for="rate4">4</label>
                                            
                                                <input name="rating" type="radio" id="rate5" value=5 onclick="document.getElementById('rating').value = this.value" />
                                                <label for="rate5">5</label>

                                                <input name="rating" type="radio" id="rate1" value=6 onclick="document.getElementById('rating').value = this.value" /> 
                                                <label for="rate1">6</label>

                                                <input name="rating" type="radio" id="rate1" value=7 onclick="document.getElementById('rating').value = this.value" /> 
                                                <label for="rate1">7</label>

                                                <input name="rating" type="radio" id="rate1" value=8 onclick="document.getElementById('rating').value = this.value" /> 
                                                <label for="rate1">8</label>

                                                <input name="rating" type="radio" id="rate1" value=9 onclick="document.getElementById('rating').value = this.value" /> 
                                                <label for="rate1">9</label>

                                                <input name="rating" type="radio" id="rate1" value=10 onclick="document.getElementById('rating').value = this.value" /> 
                                                <label for="rate1">10</label>
                                            </div>

                                            <input type="hidden" id="rating">

                                            <button onclick="RatingFilm()" type="button" class="btn-white" data-bs-dismiss="modal" aria-label="Close">vote</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- OVERLAY -->
                    </div>
                    
                    <a target="_blank" rel="noopener noreferrer" style="display:none;">
                        <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#TrailerModal"><i class="fab fa-youtube" style="font-size: 1em; margin-right: 0.2em;"></i><span> Guarda il Trailer</span></button>
                    </a>
                    <!-- OVERLAY TRAILER -->
                    <div class="modal fade" id="TrailerModal" tabindex="-1" aria-labelledby="TrailerModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-xl">
                            <div class="modal-content bg-dark text-white">
                                <div class="modal-header" style="border-bottom: 0px;">
                                    <h5 class="modal-title" id="TrailerModalLabel">Trailer</h5>
                                    <button onclick="stopvideo()" type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="ratio ratio-16x9">
                                        <iframe id="TrailerFilm" allowfullscreen></iframe>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- OVERLAY -->


                    
                    <!-- OVERLAY negozi -->
                    <div class="modal fade" id="NegoziModal" tabindex="-1" aria-labelledby="NegoziModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-xl">
                            <div class="modal-content bg-dark text-white">
                                <div class="modal-header" style="border-bottom: 0px;">
                                    <h5 class="modal-title" id="NegoziModalLabel">negozi</h5>
                                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body" id="elencoNegozi">
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- OVERLAY -->

                    
        
                    

                </div>
            </div>
            
        </div>

        <div class="row" id="rigaCorrelati" ><!-- correlati -->
            <div id="scroller_film_correlati" class="align-top overflow-auto" style="white-space: nowrap" >
            </div>
        </div>

    </div>
    <!-- /content -->



    <!-- footer -->
    <div class="container-fluid">
        <!-- produzione -->
        <div class ="row" id="rigaOtherInfo" >
            <div class="col-md-1"></div>
            <div class="col-md-6" style="margin-top: 2em; color: #c1c1c1;">
                <h3 style="color: white;">Production</h3>
                <br>
            </div>
            <div style="color: #c1c1c1; margin-top: 2em;" class="col-md-4">
                <h3 style="color: white;">Other Info</h3>
                <br>
            </div>
            <div class="col-md-1"></div>
        </div>
        <div class="row">
            <div class="col-md-1"></div>
            <div class="col-md-4" style ="margin-top:1em; margin-bottom:2em; color:#c1c1c1">
                <h5>Metodi di pagamento</h5>
                    <div style = "font-size:30px;">
                    <i class="fab fa-cc-visa"></i>
                    <i class="fab fa-cc-paypal"></i>
                    <i class="fab fa-cc-mastercard"></i>
                    <i class="fab fa-cc-apple-pay"></i>
                    <br>
                    <i class="fab fa-cc-amex"></i>
                    <i class="fab fa-cc-stripe"></i>
                    <i class="fab fa-cc-jcb"></i>
                    <i class="fab fa-cc-discover"></i>
                    </div>
            </div>
            <div class="col-md-4" style ="margin-top:1em; margin-bottom:2em; color:#c1c1c1">
                <h5>Guarda su</h5>
                <div style = "font-size:30px;">
                    <i class="fas fa-laptop"></i>
                    <i class="fas fa-tablet-alt"></i>
                    <i class="fas fa-mobile-alt"></i>
                    <i class="fas fa-desktop"></i>
                </div>
            </div>
                

        </div>
    </div>
    <!-- /footer -->

    



      

      



    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js" integrity="sha384-SR1sx49pcuLnqZUnnPwx6FCym0wLsk5JZuNx2bPPENzswTNFaQU1RDvt3wT4gWFG" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js" integrity="sha384-j0CNLUeiqtyaRmlzUHCPZ+Gy5fQu0dQ6eZ/xAww941Ai1SxSY+0EQqNXNE6DZiVc" crossorigin="anonymous"></script>
    -->
  </body>
</html>

<script>
function RatingFilm() {
    idFilm = get_from_url("id=");
    vote = document.getElementById("rating").value;
    if (idFilm != null && vote >= 1 && vote <= 10) {
        //alert("film: "+id+" voto: "+vote)
        get("https://api.themoviedb.org/3/authentication/guest_session/new?api_key="+"2bb75004dddb3cae50be3c30cc0f551d", function(response){
            
            //console.log("get response: ", response);
            
            idFilm = get_from_url("id=");
            vote = Number(document.getElementById("rating").value);

            endpoint = "https://api.themoviedb.org/3/movie/"+idFilm+"/rating?api_key=2bb75004dddb3cae50be3c30cc0f551d&guest_session_id="+response.guest_session_id;

            var xhr = new XMLHttpRequest();
            xhr.open("POST", endpoint);

            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.responseType = 'json';

            xhr.onreadystatechange = function () {
            if (xhr.readyState === 4) {
                if (xhr.status == 201) {
                    alert("grazie per la tua recensione");
                } else {
                    alert("mi dispiace c'è stato un problema, riprova");
                }
                //console.log("post response", xhr.response);
                //console.log("post status: ", xhr.status);

            }};

            var data = '{"value":'+vote+'}';
            //console.log(data)

            xhr.send(data);

            //window.location.reload();
        });
    }
    
}
</script>